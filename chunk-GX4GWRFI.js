import{a as mt}from"./chunk-SXSOOLLL.js";import{a as he}from"./chunk-U6SMVOZC.js";import{a as ot}from"./chunk-H325HP2C.js";import{a as it,d as nt}from"./chunk-XZ4HCJWZ.js";import{a as rt}from"./chunk-SHRMIYW6.js";import"./chunk-7GIE5OE5.js";import{b as lt}from"./chunk-T6Z7PU6G.js";import"./chunk-7IR6FQY6.js";import"./chunk-VOSQLLSY.js";import{f as at}from"./chunk-VDEEEHQO.js";import"./chunk-NZLHOTVQ.js";import"./chunk-JLQME5UC.js";import"./chunk-MNPH6ZK6.js";import"./chunk-EH7PTK6G.js";import"./chunk-NGGM7RPI.js";import"./chunk-EO4ZRTWE.js";import{a as ge}from"./chunk-LZZYUYSO.js";import"./chunk-YZQKBSXU.js";import"./chunk-D56ZTF4N.js";import"./chunk-6DGE2S5E.js";import{a as et,b as tt}from"./chunk-JRXN4BYE.js";import{a as Je,b as Ke,c as Ye}from"./chunk-PK5Y6STH.js";import"./chunk-Y7DWSVT7.js";import"./chunk-JOXECPUC.js";import"./chunk-2KO7AHLC.js";import"./chunk-XSQZ233G.js";import{a as q}from"./chunk-3D3NKZKE.js";import{b as $e,c as Ge,d as je}from"./chunk-CFRJ472G.js";import"./chunk-V6VP5ZUC.js";import{d as K}from"./chunk-QHSMMPEM.js";import{b as He}from"./chunk-5BCZZY3T.js";import{a as qe,b as Ze}from"./chunk-ZPLGKVPL.js";import{a as Qe,b as Ue}from"./chunk-SBWYRH7T.js";import{f as _e,g as fe}from"./chunk-3GMZJHT4.js";import"./chunk-AZDBKI4P.js";import"./chunk-FL7BS3BX.js";import"./chunk-TXJPWTOS.js";import"./chunk-ZMRRVVPG.js";import"./chunk-WRTBEKRN.js";import{a as le,b as me,c as pe,d as se,e as ce}from"./chunk-4HDWGDFD.js";import"./chunk-Q5VVKPDT.js";import"./chunk-OFQES6HH.js";import{a as de,e as ue}from"./chunk-WKOMYM5O.js";import{d as G,e as Pe,g as w,h as j,j as Oe,k as Q,l as U,o as Le,r as Be,u as Xe,w as k,x as We}from"./chunk-6GAZF5ON.js";import"./chunk-JS4TD4O2.js";import"./chunk-H5LORQQP.js";import"./chunk-U5DI5JIS.js";import{a as oe,b as re,c as ae}from"./chunk-F45NW6BW.js";import"./chunk-IK75FPLE.js";import"./chunk-BH5DKTT6.js";import"./chunk-NTMY3SYH.js";import{a as Y,b as ee,c as te,d as ie,e as ne}from"./chunk-PRNJDQ6J.js";import"./chunk-ESTIS766.js";import{ca as Z,da as J}from"./chunk-F5ALC7SR.js";import"./chunk-67WDHJZZ.js";import{a as b}from"./chunk-YN3PI5LS.js";import{m as $}from"./chunk-6E3GIBKW.js";import"./chunk-L7ZCTNHS.js";import{v as Ae,w as Ee}from"./chunk-NGTZY5Y2.js";import{$b as B,Aa as v,Ac as c,Bc as T,Fc as x,Gc as N,Hc as R,Jc as M,Kb as De,Kc as Se,Lc as Ve,Ma as u,Mc as Fe,Na as _,Ob as g,Qb as p,R as Ne,Ua as L,Uc as D,Z as E,Zb as S,ac as X,bc as W,cc as m,dc as a,dd as H,ec as f,hc as ve,ic as C,oc as h,qa as Re,qc as s,ub as r,vb as Me,wa as d,wc as we,xc as ke,yc as Ie,z as O,zc as F}from"./chunk-PHCOYEBV.js";import{a as P,b as xe}from"./chunk-VB56BUGO.js";var I=class I extends et{constructor(e){super(e);this.modalRef=e;this.nzModalData=d(Je);this.fb=d(Xe)}initForm(){this.addEditForm=this.fb.group({roleName:[null,[Pe.required]],roleDesc:[null]})}getAsyncFnData(e){return O(e)}getCurrentValue(){return He(this.addEditForm)?O(this.addEditForm.value):O(!1)}ngOnInit(){this.initForm(),this.nzModalData&&this.addEditForm.patchValue(this.nzModalData)}};I.\u0275fac=function(o){return new(o||I)(Me(Ke))},I.\u0275cmp=v({type:I,selectors:[["app-role-manage-modal"]],standalone:!0,features:[De,M],decls:11,vars:9,consts:[["nz-form","",3,"formGroup"],["nzFor","roleName","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","\u8BF7\u8F93\u5165\u89D2\u8272\u540D",3,"nzSm","nzXs"],["id","roleName","name","roleName","formControlName","roleName","nz-input","","placeholder","\u8BF7\u8F93\u5165\u89D2\u8272\u540D"],["nzFor","roleDesc",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["id","roleDesc","name","roleDesc","formControlName","roleDesc","nz-input","","placeholder","\u8BF7\u8F93\u5165\u63CF\u8FF0"]],template:function(o,n){o&1&&(m(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),c(3,"\u89D2\u8272\u540D"),a(),m(4,"nz-form-control",2),f(5,"input",3),a()(),m(6,"nz-form-item")(7,"nz-form-label",4),c(8,"\u63CF\u8FF0"),a(),m(9,"nz-form-control",5),f(10,"input",6),a()()()),o&2&&(p("formGroup",n.addEditForm),r(2),p("nzSm",4)("nzXs",24),r(2),p("nzSm",18)("nzXs",24),r(3),p("nzSm",4)("nzXs",24),r(2),p("nzSm",18)("nzXs",24))},dependencies:[k,U,G,w,j,ce,re,oe,me,le,se,pe,We,Le,Be,ae,ue,de],encapsulation:2,changeDetection:0});var Ce=I;var y=class y{constructor(){this.modalWrapService=d(tt)}getContentComponent(){return Ce}show(t={},e){return this.modalWrapService.show(this.getContentComponent(),t,e)}};y.\u0275fac=function(e){return new(e||y)},y.\u0275prov=Re({token:y,factory:y.\u0275fac,providedIn:"root"});var ze=y;var yt=["operationTpl"],vt=()=>({"padding-bottom":0}),St=()=>({xs:8,sm:16,md:24});function Ft(i,t){if(i&1){let e=C();m(0,"span",18),h("click",function(){u(e);let n=s().id,l=s();return _(l.setRole(n))}),c(1,"\u8BBE\u7F6E\u6743\u9650"),a()}}function Tt(i,t){if(i&1){let e=C();m(0,"span",18),h("click",function(){u(e);let n=s(),l=n.id,z=n.$$dataItem,dt=s();return _(dt.edit(l,z))}),c(1,"\u7F16\u8F91"),a()}}function xt(i,t){if(i&1){let e=C();m(0,"span",18),h("click",function(){u(e);let n=s().id,l=s();return _(l.del(n))}),c(1,"\u5220\u9664"),a()}}function Nt(i,t){if(i&1&&g(0,Ft,2,0,"span",17)(1,Tt,2,0,"span",17)(2,xt,2,0,"span",17),i&2){let e=s();p("appAuth",e.ActionCode.RoleManagerSetRole),r(),p("appAuth",e.ActionCode.RoleManagerEdit),r(),p("appAuth",e.ActionCode.RoleManagerDel)}}function Rt(i,t){if(i&1){let e=C();m(0,"button",20),h("click",function(){u(e);let n=s(2);return _(n.add())}),f(1,"i",21),c(2," \u65B0\u5EFA "),a()}}function Mt(i,t){if(i&1&&g(0,Rt,3,0,"button",19),i&2){let e=s();p("appAuth",e.ActionCode.RoleManagerAdd)}}var V=class V{constructor(){this.searchParam={};this.pageHeaderInfo={title:"\u89D2\u8272\u7BA1\u7406(\u6570\u636E\u5E93\u6BCF10\u5206\u949F\u4ECE\u5907\u4EFD\u6062\u590D\u4E00\u6B21)",breadcrumb:["\u9996\u9875","\u7528\u6237\u7BA1\u7406","\u89D2\u8272\u7BA1\u7406"]};this.dataList=[];this.checkedCashArray=[];this.ActionCode=q;this.destroyRef=d(L);this.dataService=d(he);this.modalSrv=d(Ye);this.cdr=d(H);this.modalService=d(ze);this.router=d($);this.message=d(K)}selectedChecked(t){this.checkedCashArray=[...t]}resetForm(){this.searchParam={},this.getDataList()}getDataList(t){this.tableConfig.loading=!0;let e={pageSize:this.tableConfig.pageSize,pageNum:t?.pageIndex||this.tableConfig.pageIndex,filters:this.searchParam};this.dataService.getRoles(e).pipe(E(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(o=>{let{list:n,total:l,pageNum:z}=o;this.dataList=[...n],this.tableConfig.total=l,this.tableConfig.pageIndex=z,this.tableLoading(!1),this.checkedCashArray=[...this.checkedCashArray]})}setRole(t){this.router.navigate(["/default/system/role-manager/set-role"],{queryParams:{id:t}})}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}tableLoading(t){this.tableConfig.loading=t,this.tableChangeDectction()}add(){this.modalService.show({nzTitle:"\u65B0\u589E"}).pipe(E(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(t=>{if(!t||t.status===0)return;let e=P({},t.modalValue);this.tableLoading(!0),this.addEditData(e,"addRoles")})}reloadTable(){this.message.info("\u5237\u65B0\u6210\u529F"),this.getDataList()}edit(t,e){console.log(e),this.dataService.getRolesDetail(t).pipe(b(this.destroyRef)).subscribe(o=>{this.modalService.show({nzTitle:"\u7F16\u8F91"},o).pipe(E(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(({modalValue:n,status:l})=>{l!==0&&(n.id=t,this.tableLoading(!0),this.addEditData(n,"editRoles"))})})}addEditData(t,e){this.dataService[e](t).pipe(b(this.destroyRef)).subscribe(()=>{this.getDataList()})}del(t){let e=[t];this.modalSrv.confirm({nzTitle:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",nzContent:"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D",nzOnOk:()=>{this.tableLoading(!0),this.dataService.delRoles(e).pipe(E(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(()=>{this.dataList.length===1&&this.tableConfig.pageIndex--,this.getDataList()})}})}changePageSize(t){this.tableConfig.pageSize=t}ngOnInit(){this.initTable()}initTable(){this.tableConfig={showCheckbox:!1,headers:[{title:"\u89D2\u8272\u540D\u79F0",field:"roleName",width:100},{title:"\u5907\u6CE8",width:100,field:"roleDesc"},{title:"\u64CD\u4F5C",tdTemplate:this.operationTpl,width:150,fixed:!0}],total:0,loading:!0,pageSize:10,pageIndex:1}}};V.\u0275fac=function(e){return new(e||V)},V.\u0275cmp=v({type:V,selectors:[["app-role-manage"]],viewQuery:function(e,o){if(e&1&&we(yt,7),e&2){let n;ke(n=Ie())&&(o.operationTpl=n.first)}},standalone:!0,features:[M],decls:25,vars:29,consts:[["operationTpl",""],["tableBtns",""],[3,"pageHeaderInfo"],[1,"normal-table-wrap"],["nzHoverable","",1,"m-b-10",3,"nzBodyStyle"],["nz-form",""],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],[3,"nzFor"],["name","roleName","nz-input","","placeholder","\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",3,"ngModelChange","ngModel"],["nz-col","",1,"text-right","p-0","m-b-10",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],["nz-button","",3,"click","nzType"],["nz-icon","","nzType","search"],["nz-button","",1,"m-l-15",3,"click"],["nz-icon","","nzTheme","outline","nzType","close-circle"],[3,"reload","btnTpl","tableTitle"],[3,"changePageNum","changePageSize","tableConfig","tableData"],["class","operate-text",3,"click",4,"appAuth"],[1,"operate-text",3,"click"],["class","m-r-8","nz-button","","nzType","primary",3,"click",4,"appAuth"],["nz-button","","nzType","primary",1,"m-r-8",3,"click"],["nz-icon","","nzType","plus"]],template:function(e,o){if(e&1){let n=C();f(0,"app-page-header",2),m(1,"div",3)(2,"nz-card",4)(3,"form",5)(4,"div",6)(5,"div",7)(6,"nz-form-item")(7,"nz-form-label",8),c(8,"\u89D2\u8272\u540D\u79F0"),a(),m(9,"nz-form-control")(10,"input",9),R("ngModelChange",function(z){return u(n),N(o.searchParam.roleName,z)||(o.searchParam.roleName=z),_(z)}),a()()()(),f(11,"div",7),m(12,"div",10)(13,"button",11),h("click",function(){return u(n),_(o.getDataList())}),f(14,"i",12),c(15," \u641C\u7D22 "),a(),m(16,"button",13),h("click",function(){return u(n),_(o.resetForm())}),f(17,"i",14),c(18," \u91CD\u7F6E "),a()()()()(),m(19,"app-card-table-wrap",15),h("reload",function(){return u(n),_(o.reloadTable())}),m(20,"app-ant-table",16),h("changePageNum",function(z){return u(n),_(o.getDataList(z))})("changePageSize",function(z){return u(n),_(o.changePageSize(z))}),a(),g(21,Nt,3,3,"ng-template",null,0,D),a()(),g(23,Mt,1,1,"ng-template",null,1,D)}if(e&2){let n=F(24);p("pageHeaderInfo",o.pageHeaderInfo),r(2),p("nzBodyStyle",Se(27,vt)),r(2),p("nzGutter",Se(28,St)),r(),p("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),r(5),x("ngModel",o.searchParam.roleName),r(),p("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),r(),p("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),r(),p("nzType","primary"),r(6),p("btnTpl",n)("tableTitle","\u89D2\u8272\u5217\u8868"),r(),p("tableConfig",o.tableConfig)("tableData",o.dataList)}},dependencies:[ge,fe,_e,k,U,G,w,j,Q,Oe,ce,re,oe,me,le,se,pe,ae,ue,de,ne,ie,Y,ee,te,J,Z,lt,at,ot],encapsulation:2,changeDetection:0});var be=V;var ct=(i,t)=>({$implicit:i,isOpen:t}),Dt=i=>({paddingLeft:i});function wt(i,t){i&1&&c(0,"\u8FD4\u56DE")}function kt(i,t){if(i&1){let e=C();m(0,"span",12),h("click",function(){u(e);let n=s().$implicit;return _(n.isOpen=!n.isOpen)}),f(1,"i",13),m(2,"span",14),c(3),a()()}if(i&2){let e=s().$implicit;r(),p("nzType",e.isOpen?"down":"right"),r(2),T(e.isOpen?"\u6536\u8D77":"\u5C55\u5F00")}}function It(i,t){i&1&&ve(0)}function Vt(i,t){if(i&1){let e=C();m(0,"span",12),h("click",function(){u(e);let n=s(2).$implicit;return _(n.isOpen=!n.isOpen)}),f(1,"i",13),m(2,"span",14),c(3),a()()}if(i&2){let e=s(2).$implicit;r(),p("nzType",e.isOpen?"down":"right"),r(2),T(e.isOpen?"\u6536\u8D77":"\u5C55\u5F00")}}function At(i,t){if(i&1){let e=C();m(0,"div",15)(1,"label",7),R("ngModelChange",function(n){u(e);let l=s().$implicit;return N(l.checked,n)||(l.checked=n),_(n)}),c(2),a(),g(3,Vt,4,2,"span",8),a()}if(i&2){let e=s().$implicit;p("ngStyle",Ve(4,Dt,e.level*16+"px")),r(),x("ngModel",e.checked),r(),T(e.menuName),r(),S(e.children&&e.children.length>0?3:-1)}}function Et(i,t){if(i&1){let e=C();m(0,"label",7),R("ngModelChange",function(n){let l=u(e).$implicit;return N(l.checked,n)||(l.checked=n),_(n)}),c(1),a()}if(i&2){let e=t.$implicit;x("ngModel",e.checked),r(),T(e.menuName)}}function Pt(i,t){if(i&1&&(m(0,"div",16)(1,"span"),c(2,"\u64CD\u4F5C\u6743\u9650\uFF1A"),a(),X(3,Et,2,2,"label",17,B),f(5,"nz-divider",9),a()),i&2){let e=s(4).$implicit;r(3),W(e)}}function Ot(i,t){if(i&1&&g(0,Pt,6,0,"div",16),i&2){let e=s().$index;S(e===0?0:-1)}}function Lt(i,t){i&1&&ve(0)}function Bt(i,t){if(i&1&&g(0,At,4,6,"div",15)(1,Ot,1,1)(2,Lt,1,0,"ng-container",11),i&2){let e=t.$implicit;s(3);let o=F(9);S(e.menuType==="C"?0:1),r(2),p("ngTemplateOutlet",o)("ngTemplateOutletContext",Fe(3,ct,e.children,e.isOpen))}}function Xt(i,t){if(i&1&&X(0,Bt,3,6,"ng-container",null,B),i&2){let e=s().$implicit;W(e)}}function Wt(i,t){if(i&1&&g(0,Xt,2,0),i&2){let e=t.isOpen;S(e?0:-1)}}function Ht(i,t){if(i&1){let e=C();m(0,"li")(1,"div",6)(2,"label",7),R("ngModelChange",function(n){let l=u(e).$implicit;return N(l.checked,n)||(l.checked=n),_(n)}),c(3),a(),g(4,kt,4,2,"span",8),a(),f(5,"nz-divider",9),m(6,"div",10),g(7,It,1,0,"ng-container",11),a(),g(8,Wt,1,1,"ng-template",null,1,D),a()}if(i&2){let e=t.$implicit,o=F(9);r(2),x("ngModel",e.checked),r(),T(e.menuName),r(),S(e.children&&e.children.length>0?4:-1),r(3),p("ngTemplateOutlet",o)("ngTemplateOutletContext",Fe(5,ct,e.children,e.isOpen))}}var A=class A{constructor(){this.pageHeaderInfo={title:"\u8BBE\u7F6E\u6743\u9650",desc:"\u5F53\u524D\u89D2\u8272\uFF1A",breadcrumb:["\u9996\u9875","\u7528\u6237\u7BA1\u7406","\u89D2\u8272\u7BA1\u7406","\u8BBE\u7F6E\u6743\u9650"]};this.authCodeArr=[];this.permissionList=[];this.destroyRef=d(L);this.dataService=d(he);this.menusService=d(mt);this.router=d($);this.message=d(K);this.cdr=d(H)}initPermission(){this.dataService.getPermissionById(this.id).pipe(Ne(t=>(this.authCodeArr=t,this.menusService.getMenuList({pageNum:0,pageSize:0}))),b(this.destroyRef)).subscribe(t=>{let e=t.list;e.forEach(o=>{o.isOpen=!1,o.checked=this.authCodeArr.includes(o.code)}),this.permissionList=Ge($e(e)),this.cdr.markForCheck()})}getRoleName(){this.dataService.getRolesDetail(+this.id).pipe(b(this.destroyRef)).subscribe(({roleName:t})=>{this.pageHeaderInfo=xe(P({},this.pageHeaderInfo),{desc:`\u5F53\u524D\u89D2\u8272\uFF1A${t}`}),this.cdr.markForCheck()})}back(){this.router.navigateByUrl("/default/system/role-manager")}submit(){let t=[...this.permissionList],e=je(t),o=[];e.forEach(l=>{l.checked&&o.push(`${l.id}`)});let n={permissionIds:o,roleId:+this.id};this.dataService.updatePermission(n).pipe(b(this.destroyRef)).subscribe(()=>{this.message.success("\u8BBE\u7F6E\u6210\u529F\uFF0C\u91CD\u65B0\u767B\u5F55\u540E\u751F\u6548")})}_onReuseInit(){this.ngOnInit()}ngOnInit(){this.getRoleName(),this.initPermission()}};A.\u0275fac=function(e){return new(e||A)},A.\u0275cmp=v({type:A,selectors:[["app-set-role"]],inputs:{id:"id"},standalone:!0,features:[M],decls:13,vars:3,consts:[["backTpl",""],["permissionTpl",""],[3,"backTpl","backUrl","pageHeaderInfo"],[1,"normal-table-wrap"],["nz-button","","nzType","primary",1,"right",3,"click"],["nz-button","","nzGhost","","nzType","primary",1,"right","m-l-20",3,"click"],[1,"first-menu"],["nz-checkbox","",3,"ngModelChange","ngModel"],[1,"hand-model"],[1,"m-0"],["nz-result-content","",1,"m-0","p-0"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"hand-model",3,"click"],["nz-icon","","nzTheme","outline",3,"nzType"],[1,"operate-text"],[1,"first-menu",3,"ngStyle"],[1,"operate-line","li-height","m-0","p-0","p-l-35"],["nz-checkbox","",3,"ngModel"]],template:function(e,o){if(e&1){let n=C();f(0,"app-page-header",2),g(1,wt,1,0,"ng-template",null,0,D),m(3,"div",3)(4,"nz-card")(5,"ul"),X(6,Ht,10,8,"li",null,B),a()()(),m(8,"app-footer-submit")(9,"button",4),h("click",function(){return u(n),_(o.submit())}),c(10,"\u63D0\u4EA4"),a(),m(11,"button",5),h("click",function(){return u(n),_(o.back())}),c(12,"\u8FD4\u56DE"),a()()}if(e&2){let n=F(2);p("backTpl",n)("backUrl","/default/system/role-manager")("pageHeaderInfo",o.pageHeaderInfo),r(6),W(o.permissionList)}},dependencies:[ge,fe,_e,Ue,Qe,k,w,Q,J,Z,ne,ie,Y,ee,Ze,qe,nt,it,Ee,Ae,rt,te],styles:[`.li-height{height:40px;line-height:40px}.first-menu{display:flex;align-items:center;justify-content:space-between;height:40px;line-height:40px}
`],encapsulation:2,changeDetection:0});var ye=A;var xn=[{path:"",component:be,title:"\u89D2\u8272\u7BA1\u7406",data:{key:"role-manage"}},{path:"set-role",component:ye,title:"\u89D2\u8272\u7BA1\u7406",data:{key:"set-role",authCode:q.RoleManagerSetRole}}];export{xn as default};
