import{a as $e}from"./chunk-AEJE5FTV.js";import{a as We}from"./chunk-H325HP2C.js";import{a as Je,b as Ye}from"./chunk-T6Z7PU6G.js";import"./chunk-7IR6FQY6.js";import"./chunk-VOSQLLSY.js";import"./chunk-VDEEEHQO.js";import{a as Ue,b as Ze}from"./chunk-NZLHOTVQ.js";import{a as Ge,b as He}from"./chunk-J7EF4AP7.js";import"./chunk-JLQME5UC.js";import"./chunk-MNPH6ZK6.js";import"./chunk-EH7PTK6G.js";import{a as Qe,b as qe,c as je}from"./chunk-NGGM7RPI.js";import{b as Ie,h as Ae,i as Pe}from"./chunk-EO4ZRTWE.js";import{a as Ke}from"./chunk-LZZYUYSO.js";import"./chunk-YZQKBSXU.js";import"./chunk-D56ZTF4N.js";import"./chunk-6DGE2S5E.js";import{a as ke,b as Be}from"./chunk-JRXN4BYE.js";import{a as Re,b as Xe,c as Oe}from"./chunk-PK5Y6STH.js";import"./chunk-Y7DWSVT7.js";import"./chunk-JOXECPUC.js";import"./chunk-2KO7AHLC.js";import"./chunk-XSQZ233G.js";import{a as be}from"./chunk-3D3NKZKE.js";import{b as Se,d as Te}from"./chunk-CFRJ472G.js";import"./chunk-V6VP5ZUC.js";import{d as Ne}from"./chunk-QHSMMPEM.js";import{b as De}from"./chunk-5BCZZY3T.js";import"./chunk-ZPLGKVPL.js";import"./chunk-SBWYRH7T.js";import{f as Ve,g as Le}from"./chunk-3GMZJHT4.js";import"./chunk-AZDBKI4P.js";import"./chunk-FL7BS3BX.js";import"./chunk-TXJPWTOS.js";import"./chunk-WRTBEKRN.js";import{a as X,b as O,c as k,d as B,e as G}from"./chunk-4HDWGDFD.js";import"./chunk-Q5VVKPDT.js";import"./chunk-OFQES6HH.js";import{a as H,e as W}from"./chunk-WKOMYM5O.js";import{d as w,e as ue,g as x,h as V,j as fe,k as ze,l as L,o as ge,r as _e,u as Ce,w as I,x as he}from"./chunk-6GAZF5ON.js";import"./chunk-JS4TD4O2.js";import"./chunk-H5LORQQP.js";import"./chunk-U5DI5JIS.js";import{a as A,b as P,c as R}from"./chunk-F45NW6BW.js";import"./chunk-IK75FPLE.js";import"./chunk-BH5DKTT6.js";import"./chunk-NTMY3SYH.js";import{a as Me,b as Ee,c as Fe,d as we,e as xe}from"./chunk-PRNJDQ6J.js";import"./chunk-ESTIS766.js";import{ca as ye,da as ve}from"./chunk-F5ALC7SR.js";import"./chunk-67WDHJZZ.js";import{a as b}from"./chunk-YN3PI5LS.js";import"./chunk-6E3GIBKW.js";import"./chunk-L7ZCTNHS.js";import{w as ce}from"./chunk-NGTZY5Y2.js";import{$b as ae,Aa as E,Ac as l,Cc as se,Fc as J,Gc as Y,Hc as $,Jc as F,Kb as re,Kc as ee,Ma as u,Na as f,Ob as C,Qb as r,Ua as ne,Uc as h,Z as y,Zb as j,ac as pe,bc as me,cc as p,dc as m,dd as de,ec as g,hc as le,ic as v,oc as _,qa as ie,qc as z,ub as a,vb as oe,wa as c,wc as K,xc as U,yc as Z,z as M,zc as N}from"./chunk-PHCOYEBV.js";import{a as te}from"./chunk-VB56BUGO.js";function mt(o,t){if(o&1&&l(0),o&2){let e=z().$implicit;se(" ",e.errors.message," ")}}function lt(o,t){o&1&&l(0," \u5FC5\u586B\u9879 ")}function st(o,t){if(o&1&&C(0,mt,1,1)(1,lt,1,0),o&2){let e=t.$implicit;j(e.hasError("message")?0:-1),a(),j(e.hasError("required")?1:-1)}}var S=class S extends ke{constructor(e){super(e);this.modalRef=e;this.nzModalData=c(Re);this.fb=c(Ce)}initForm(){this.addEditForm=this.fb.group({departmentName:[null,[ue.required]],state:[!0],orderNum:[0]})}getAsyncFnData(e){return M(e)}getCurrentValue(){return De(this.addEditForm)?M(this.addEditForm.value):M(!1)}ngOnInit(){this.initForm(),this.nzModalData&&this.addEditForm.patchValue(this.nzModalData)}};S.\u0275fac=function(i){return new(i||S)(oe(Xe))},S.\u0275cmp=E({type:S,selectors:[["app-dept-manage-modal"]],standalone:!0,features:[re,F],decls:22,vars:18,consts:[["combineTpl",""],["nz-form","",3,"formGroup"],["nzFor","departmentName","nzRequired","",3,"nzSm","nzXs"],[3,"nzErrorTip","nzSm","nzXs"],["id","departmentName","name","departmentName","formControlName","departmentName","nz-input","","placeholder","\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"],["nzFor","state","nzRequired","",3,"nzSm","nzXs"],["formControlName","state"],["nz-radio","",3,"nzValue"],["nzFor","orderNum","nzRequired","",3,"nzSm","nzXs"],["id","orderNum","name","orderNum","formControlName","orderNum","nz-input","","placeholder","\u6392\u5E8F"]],template:function(i,n){if(i&1&&(p(0,"form",1)(1,"nz-form-item")(2,"nz-form-label",2),l(3,"\u90E8\u95E8\u540D\u79F0"),m(),p(4,"nz-form-control",3),g(5,"input",4),m()(),p(6,"nz-form-item")(7,"nz-form-label",5),l(8,"\u90E8\u95E8\u72B6\u6001"),m(),p(9,"nz-form-control",3)(10,"nz-radio-group",6)(11,"label",7),l(12,"\u7981\u7528"),m(),p(13,"label",7),l(14,"\u53EF\u7528"),m()()()(),p(15,"nz-form-item")(16,"nz-form-label",8),l(17,"\u6392\u5E8F"),m(),p(18,"nz-form-control",3),g(19,"input",9),m()()(),C(20,st,2,2,"ng-template",null,0,h)),i&2){let s=N(21);r("formGroup",n.addEditForm),a(2),r("nzSm",6)("nzXs",24),a(2),r("nzErrorTip",s)("nzSm",14)("nzXs",24),a(3),r("nzSm",6)("nzXs",24),a(2),r("nzErrorTip",s)("nzSm",14)("nzXs",24),a(2),r("nzValue",!1),a(2),r("nzValue",!0),a(3),r("nzSm",6)("nzXs",24),a(2),r("nzErrorTip",s)("nzSm",14)("nzXs",24)}},dependencies:[I,L,w,x,V,G,P,A,O,X,B,k,he,ge,_e,R,W,H,je,qe,Qe],encapsulation:2,changeDetection:0});var Q=S;var D=class D{constructor(){this.modalWrapService=c(Be)}getContentComponent(){return Q}show(t={},e){return this.modalWrapService.show(this.getContentComponent(),t,e)}};D.\u0275fac=function(e){return new(e||D)},D.\u0275prov=ie({token:D,factory:D.\u0275fac,providedIn:"root"});var q=D;var dt=["operationTpl"],ct=["state"],ut=()=>({"padding-bottom":0}),ft=()=>({xs:8,sm:16,md:24});function zt(o,t){if(o&1&&g(0,"nz-option",14),o&2){let e=t.$implicit;r("nzLabel",e.label)("nzValue",e.value)}}function gt(o,t){if(o&1){let e=v();p(0,"span",23),_("click",function(){u(e);let n=z(),s=n.fatherId,d=n.id,it=z();return f(it.edit(d,s))}),l(1,"\u7F16\u8F91"),m()}}function _t(o,t){if(o&1){let e=v();p(0,"span",23),_("click",function(){u(e);let n=z().id,s=z();return f(s.del(n))}),l(1,"\u5220\u9664"),m()}}function Ct(o,t){if(o&1){let e=v();p(0,"span",23),_("click",function(){u(e);let n=z().id,s=z();return f(s.add(n))}),l(1,"\u6DFB\u52A0\u4E0B\u7EA7"),m()}}function ht(o,t){if(o&1&&C(0,gt,2,0,"span",22)(1,_t,2,0,"span",22)(2,Ct,2,0,"span",22),o&2){let e=z();r("appAuth",e.ActionCode.DeptEdit),a(),r("appAuth",e.ActionCode.DeptDel),a(),r("appAuth",e.ActionCode.DeptAddLowLevel)}}function bt(o,t){if(o&1){let e=v();p(0,"button",24),_("click",function(){u(e);let n=z();return f(n.add(0))}),g(1,"i",25),l(2," \u65B0\u5EFA "),m()}}function Dt(o,t){o&1&&le(0)}function yt(o,t){if(o&1&&C(0,Dt,1,0,"ng-container",26),o&2){let e=t.state;z();let i=N(35),n=N(37);r("ngTemplateOutlet",e?i:n)}}function vt(o,t){o&1&&(p(0,"nz-tag",27),l(1,"\u53EF\u7528"),m()),o&2&&r("nzColor","green")}function Nt(o,t){o&1&&(p(0,"nz-tag",27),l(1,"\u7981\u7528"),m()),o&2&&r("nzColor","magenta")}var T=class T{constructor(){this.ActionCode=be;this.searchParam={};this.destroyRef=c(ne);this.pageHeaderInfo={title:"\u90E8\u95E8\u7BA1\u7406(\u53EAmock\u4E86\u5F00\u53D1\u90E8\u95E8\u8FD9\u4E00\u6761\u6570\u636E)",breadcrumb:["\u9996\u9875","\u7CFB\u7EDF\u7BA1\u7406","\u90E8\u95E8\u7BA1\u7406"]};this.dataList=[];this.stateOptions=[];this.deptModalService=c(q);this.dataService=c($e);this.modalSrv=c(Oe);this.message=c(Ne);this.cdr=c(de)}reloadTable(){this.message.info("\u5DF2\u7ECF\u5237\u65B0\u4E86"),this.getDataList()}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}tableLoading(t){this.tableConfig.loading=t,this.tableChangeDectction()}getDataList(t){this.tableConfig.loading=!0;let e={pageSize:0,pageNum:0,filters:this.searchParam};this.dataService.getDepts(e).pipe(y(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(i=>{let n=Se(i.list);this.dataList=Te(n),this.tableLoading(!1)})}check(t,e,i){this.message.success(t)}resetForm(){this.searchParam={},this.getDataList()}add(t){this.deptModalService.show({nzTitle:"\u65B0\u589E"}).pipe(y(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(e=>{if(!e||e.status===0)return;let i=te({},e.modalValue);i.fatherId=t,this.tableLoading(!0),this.addEditData(i,"addDepts")})}addEditData(t,e){this.dataService[e](t).pipe(y(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(()=>{this.getDataList()})}del(t){let e=[t];this.modalSrv.confirm({nzTitle:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",nzContent:"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D",nzOnOk:()=>{this.tableLoading(!0),this.dataService.delDepts(e).pipe(y(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(()=>{this.dataList.length===1&&this.tableConfig.pageIndex--,this.getDataList()})}})}edit(t,e){this.dataService.getDeptsDetail(t).pipe(b(this.destroyRef)).subscribe(i=>{this.deptModalService.show({nzTitle:"\u7F16\u8F91"},i).pipe(y(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(({modalValue:n,status:s})=>{s!==0&&(n.id=t,n.fatherId=e,this.tableLoading(!0),this.addEditData(n,"editDepts"))})})}changePageSize(t){this.tableConfig.pageSize=t}initTable(){this.tableConfig={headers:[{title:"\u90E8\u95E8\u540D\u79F0",width:230,field:"departmentName"},{title:"\u90E8\u95E8\u72B6\u6001",field:"state",tdTemplate:this.state,width:100},{title:"\u6392\u5E8F",field:"orderNum",width:100},{title:"\u521B\u5EFA\u65F6\u95F4",field:"createTime",pipe:"date:yyyy-MM-dd HH:mm",width:180},{title:"\u64CD\u4F5C",tdTemplate:this.operationTpl,width:180,fixed:!1,fixedDir:"right"}],total:0,showCheckbox:!1,loading:!1,pageSize:10,pageIndex:1}}ngOnInit(){this.initTable(),this.stateOptions=[...Ze.transformMapToArray(Ue.available,2)]}};T.\u0275fac=function(e){return new(e||T)},T.\u0275cmp=E({type:T,selectors:[["app-dept"]],viewQuery:function(e,i){if(e&1&&(K(dt,7),K(ct,7)),e&2){let n;U(n=Z())&&(i.operationTpl=n.first),U(n=Z())&&(i.state=n.first)}},standalone:!0,features:[F],decls:38,vars:30,consts:[["operationTpl",""],["tableBtns",""],["state",""],["yesTpl",""],["notTpl",""],[3,"pageHeaderInfo"],[1,"normal-table-wrap"],["nzHoverable","",1,"m-b-10",3,"nzBodyStyle"],["nz-form",""],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],[3,"nzFor"],["name","departmentName","nz-input","","placeholder","\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",3,"ngModelChange","ngModel"],["name","state","nzAllowClear","","nzPlaceHolder","\u4E0B\u62C9\u9009\u62E9",3,"ngModelChange","ngModel"],[3,"nzLabel","nzValue"],["nz-col","",1,"text-right","p-0","m-b-10",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],["nz-button","",3,"click","nzType"],["nz-icon","","nzType","search"],["nz-button","",1,"m-l-15",3,"click"],["nz-icon","","nzTheme","outline","nzType","close-circle"],[3,"reload","btnTpl","tableTitle"],[3,"changePageNum","changePageSize","tableConfig","tableData"],["class","operate-text",3,"click",4,"appAuth"],[1,"operate-text",3,"click"],["nz-button","","nzType","primary",1,"m-r-8",3,"click"],["nz-icon","","nzType","plus"],[4,"ngTemplateOutlet"],[3,"nzColor"]],template:function(e,i){if(e&1){let n=v();g(0,"app-page-header",5),p(1,"div",6)(2,"nz-card",7)(3,"form",8)(4,"div",9)(5,"div",10)(6,"nz-form-item")(7,"nz-form-label",11),l(8,"\u90E8\u95E8\u540D\u79F0"),m(),p(9,"nz-form-control")(10,"input",12),$("ngModelChange",function(d){return u(n),Y(i.searchParam.departmentName,d)||(i.searchParam.departmentName=d),f(d)}),m()()()(),p(11,"div",10)(12,"nz-form-item")(13,"nz-form-label",11),l(14,"\u72B6\u6001"),m(),p(15,"nz-form-control")(16,"nz-select",13),$("ngModelChange",function(d){return u(n),Y(i.searchParam.state,d)||(i.searchParam.state=d),f(d)}),pe(17,zt,1,2,"nz-option",14,ae),m()()()(),p(19,"div",15)(20,"button",16),_("click",function(){return u(n),f(i.getDataList())}),g(21,"i",17),l(22," \u641C\u7D22 "),m(),p(23,"button",18),_("click",function(){return u(n),f(i.resetForm())}),g(24,"i",19),l(25," \u91CD\u7F6E "),m()()()()(),p(26,"app-card-table-wrap",20),_("reload",function(){return u(n),f(i.reloadTable())}),p(27,"app-tree-table",21),_("changePageNum",function(d){return u(n),f(i.getDataList(d))})("changePageSize",function(d){return u(n),f(i.changePageSize(d))}),m(),C(28,ht,3,3,"ng-template",null,0,h),m()(),C(30,bt,3,0,"ng-template",null,1,h)(32,yt,1,1,"ng-template",null,2,h)(34,vt,2,1,"ng-template",null,3,h)(36,Nt,2,1,"ng-template",null,4,h)}if(e&2){let n=N(31);r("pageHeaderInfo",i.pageHeaderInfo),a(2),r("nzBodyStyle",ee(28,ut)),a(2),r("nzGutter",ee(29,ft)),a(),r("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),a(5),J("ngModel",i.searchParam.departmentName),a(),r("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),a(5),J("ngModel",i.searchParam.state),a(),me(i.stateOptions),a(2),r("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),a(),r("nzType","primary"),a(6),r("btnTpl",n)("tableTitle","\u90E8\u95E8\u5217\u8868"),a(),r("tableConfig",i.tableConfig)("tableData",i.dataList)}},dependencies:[Ke,Le,Ve,I,L,w,x,V,ze,fe,G,P,A,O,X,B,k,R,W,H,Pe,Ie,Ae,xe,we,Me,Ee,Fe,ve,ye,Ye,Je,We,ce,He,Ge],encapsulation:2,changeDetection:0});var tt=T;export{tt as DeptComponent};
