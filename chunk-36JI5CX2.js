import{a as it}from"./chunk-OITA2RX5.js";import{a as fe}from"./chunk-SJXZYIO6.js";import{a as Ke}from"./chunk-NU3TMEUA.js";import{a as Ze,d as Je}from"./chunk-XZ4HCJWZ.js";import{a as Ye}from"./chunk-EWT64ETF.js";import"./chunk-YDBLYT6L.js";import{b as tt}from"./chunk-CKN7YGWJ.js";import"./chunk-KBJ4B6OQ.js";import"./chunk-7IR6FQY6.js";import"./chunk-VOSQLLSY.js";import{h as et}from"./chunk-4ECBHLEL.js";import"./chunk-WCDVIYTB.js";import"./chunk-EH7PTK6G.js";import"./chunk-NGGM7RPI.js";import"./chunk-EO4ZRTWE.js";import{a as _e}from"./chunk-HPYP3UGD.js";import"./chunk-YZQKBSXU.js";import"./chunk-D56ZTF4N.js";import"./chunk-6DGE2S5E.js";import{a as qe,b as Qe}from"./chunk-KMMMP376.js";import{a as Ge,b as je,c as Ue}from"./chunk-7CZ4KCVK.js";import"./chunk-Y7DWSVT7.js";import"./chunk-37EPPSG7.js";import"./chunk-2KO7AHLC.js";import"./chunk-XSQZ233G.js";import{a as U}from"./chunk-3D3NKZKE.js";import{b as Pe,c as Oe,d as Xe}from"./chunk-BR5TRSLO.js";import"./chunk-V6VP5ZUC.js";import{d as Z}from"./chunk-QHSMMPEM.js";import{b as Ae}from"./chunk-AHKPXNLE.js";import{a as He,b as $e}from"./chunk-ZPLGKVPL.js";import{a as Be,b as We}from"./chunk-SBWYRH7T.js";import{f as de,g as ue}from"./chunk-3GMZJHT4.js";import"./chunk-AZDBKI4P.js";import"./chunk-FL7BS3BX.js";import"./chunk-S32L4EJW.js";import"./chunk-ZMRRVVPG.js";import"./chunk-WRTBEKRN.js";import{a as re,b as ae,c as le,d as se,e as me}from"./chunk-4HDWGDFD.js";import"./chunk-NFHEPG3N.js";import"./chunk-OFQES6HH.js";import{a as pe,e as ce}from"./chunk-WKOMYM5O.js";import{d as H,e as we,g as k,h as $,j as ke,k as G,l as j,o as Ve,r as Ee,u as Ie,w as V,x as Le}from"./chunk-6GAZF5ON.js";import"./chunk-JS4TD4O2.js";import"./chunk-H5LORQQP.js";import"./chunk-U5DI5JIS.js";import{a as ie,b as ne,c as oe}from"./chunk-F45NW6BW.js";import"./chunk-IK75FPLE.js";import"./chunk-BH5DKTT6.js";import"./chunk-NTMY3SYH.js";import{a as J,b as K,c as Y,d as ee,e as te}from"./chunk-VPF7NIXW.js";import{ca as q,da as Q}from"./chunk-F5ALC7SR.js";import"./chunk-67WDHJZZ.js";import{a as b}from"./chunk-YN3PI5LS.js";import{m as W}from"./chunk-6E3GIBKW.js";import"./chunk-L7ZCTNHS.js";import{v as Re,w as Ne}from"./chunk-NGTZY5Y2.js";import{$b as P,Aa as v,Ac as d,Bc as T,Fc as D,Gc as M,Hc as R,Jc as N,Kb as xe,Kc as he,Lc as Me,Ma as _,Mc as Ce,Na as f,Ob as C,Qb as m,R as be,Ua as A,Uc as w,Z as E,Zb as x,ac as O,bc as X,cc as s,dc as l,dd as B,ec as h,hc as ge,ic as y,oc as z,qa as Se,qc as c,ub as a,vb as ve,wa as u,wc as Fe,xc as Te,yc as De,z as L,zc as F}from"./chunk-PHCOYEBV.js";import{a as I,b as ye}from"./chunk-VB56BUGO.js";var ot=(()=>{let o=class o extends qe{constructor(n){super(n),this.modalRef=n,this.nzModalData=u(Ge),this.fb=u(Ie)}initForm(){this.addEditForm=this.fb.group({roleName:[null,[we.required]],roleDesc:[null]})}getAsyncFnData(n){return L(n)}getCurrentValue(){return Ae(this.addEditForm)?L(this.addEditForm.value):L(!1)}ngOnInit(){this.initForm(),this.nzModalData&&this.addEditForm.patchValue(this.nzModalData)}};o.\u0275fac=function(t){return new(t||o)(ve(je))},o.\u0275cmp=v({type:o,selectors:[["app-role-manage-modal"]],standalone:!0,features:[xe,N],decls:11,vars:9,consts:[["nz-form","",3,"formGroup"],["nzFor","roleName","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","\u8BF7\u8F93\u5165\u89D2\u8272\u540D",3,"nzSm","nzXs"],["id","roleName","name","roleName","formControlName","roleName","nz-input","","placeholder","\u8BF7\u8F93\u5165\u89D2\u8272\u540D"],["nzFor","roleDesc",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["id","roleDesc","name","roleDesc","formControlName","roleDesc","nz-input","","placeholder","\u8BF7\u8F93\u5165\u63CF\u8FF0"]],template:function(t,r){t&1&&(s(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),d(3,"\u89D2\u8272\u540D"),l(),s(4,"nz-form-control",2),h(5,"input",3),l()(),s(6,"nz-form-item")(7,"nz-form-label",4),d(8,"\u63CF\u8FF0"),l(),s(9,"nz-form-control",5),h(10,"input",6),l()()()),t&2&&(m("formGroup",r.addEditForm),a(2),m("nzSm",4)("nzXs",24),a(2),m("nzSm",18)("nzXs",24),a(3),m("nzSm",4)("nzXs",24),a(2),m("nzSm",18)("nzXs",24))},dependencies:[V,j,H,k,$,me,ne,ie,ae,re,se,le,Le,Ve,Ee,oe,ce,pe],encapsulation:2,changeDetection:0});let e=o;return e})();var rt=(()=>{let o=class o{constructor(){this.modalWrapService=u(Qe)}getContentComponent(){return ot}show(n={},t){return this.modalWrapService.show(this.getContentComponent(),n,t)}};o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=Se({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();var ht=["operationTpl"],Ct=()=>({"padding-bottom":0}),zt=()=>({xs:8,sm:16,md:24});function yt(e,o){if(e&1){let i=y();s(0,"span",18),z("click",function(){_(i);let t=c().id,r=c();return f(r.setRole(t))}),d(1,"\u8BBE\u7F6E\u6743\u9650"),l()}}function bt(e,o){if(e&1){let i=y();s(0,"span",18),z("click",function(){_(i);let t=c(),r=t.id,p=t.$$dataItem,g=c();return f(g.edit(r,p))}),d(1,"\u7F16\u8F91"),l()}}function St(e,o){if(e&1){let i=y();s(0,"span",18),z("click",function(){_(i);let t=c().id,r=c();return f(r.del(t))}),d(1,"\u5220\u9664"),l()}}function vt(e,o){if(e&1&&C(0,yt,2,0,"span",17)(1,bt,2,0,"span",17)(2,St,2,0,"span",17),e&2){let i=c();m("appAuth",i.ActionCode.RoleManagerSetRole),a(),m("appAuth",i.ActionCode.RoleManagerEdit),a(),m("appAuth",i.ActionCode.RoleManagerDel)}}function xt(e,o){if(e&1){let i=y();s(0,"button",20),z("click",function(){_(i);let t=c(2);return f(t.add())}),h(1,"i",21),d(2," \u65B0\u5EFA "),l()}}function Ft(e,o){if(e&1&&C(0,xt,3,0,"button",19),e&2){let i=c();m("appAuth",i.ActionCode.RoleManagerAdd)}}var at=(()=>{let o=class o{constructor(){this.searchParam={},this.pageHeaderInfo={title:"\u89D2\u8272\u7BA1\u7406(\u6570\u636E\u5E93\u6BCF10\u5206\u949F\u4ECE\u5907\u4EFD\u6062\u590D\u4E00\u6B21)",breadcrumb:["\u9996\u9875","\u7528\u6237\u7BA1\u7406","\u89D2\u8272\u7BA1\u7406"]},this.dataList=[],this.checkedCashArray=[],this.ActionCode=U,this.destroyRef=u(A),this.dataService=u(fe),this.modalSrv=u(Ue),this.cdr=u(B),this.modalService=u(rt),this.router=u(W),this.message=u(Z)}selectedChecked(n){this.checkedCashArray=[...n]}resetForm(){this.searchParam={},this.getDataList()}getDataList(n){this.tableConfig.loading=!0;let t={pageSize:this.tableConfig.pageSize,pageNum:n?.pageIndex||this.tableConfig.pageIndex,filters:this.searchParam};this.dataService.getRoles(t).pipe(E(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(r=>{let{list:p,total:g,pageNum:S}=r;this.dataList=[...p],this.tableConfig.total=g,this.tableConfig.pageIndex=S,this.tableLoading(!1),this.checkedCashArray=[...this.checkedCashArray]})}setRole(n){this.router.navigate(["/default/system/role-manager/set-role"],{queryParams:{id:n}})}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}tableLoading(n){this.tableConfig.loading=n,this.tableChangeDectction()}add(){this.modalService.show({nzTitle:"\u65B0\u589E"}).pipe(E(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(n=>{if(!n||n.status===0)return;let t=I({},n.modalValue);this.tableLoading(!0),this.addEditData(t,"addRoles")})}reloadTable(){this.message.info("\u5237\u65B0\u6210\u529F"),this.getDataList()}edit(n,t){console.log(t),this.dataService.getRolesDetail(n).pipe(b(this.destroyRef)).subscribe(r=>{this.modalService.show({nzTitle:"\u7F16\u8F91"},r).pipe(E(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(({modalValue:p,status:g})=>{g!==0&&(p.id=n,this.tableLoading(!0),this.addEditData(p,"editRoles"))})})}addEditData(n,t){this.dataService[t](n).pipe(b(this.destroyRef)).subscribe(()=>{this.getDataList()})}del(n){let t=[n];this.modalSrv.confirm({nzTitle:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",nzContent:"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D",nzOnOk:()=>{this.tableLoading(!0),this.dataService.delRoles(t).pipe(E(()=>{this.tableLoading(!1)}),b(this.destroyRef)).subscribe(()=>{this.dataList.length===1&&this.tableConfig.pageIndex--,this.getDataList()})}})}changePageSize(n){this.tableConfig.pageSize=n}ngOnInit(){this.initTable()}initTable(){this.tableConfig={showCheckbox:!1,headers:[{title:"\u89D2\u8272\u540D\u79F0",field:"roleName",width:100},{title:"\u5907\u6CE8",width:100,field:"roleDesc"},{title:"\u64CD\u4F5C",tdTemplate:this.operationTpl,width:150,fixed:!0}],total:0,loading:!0,pageSize:10,pageIndex:1}}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=v({type:o,selectors:[["app-role-manage"]],viewQuery:function(t,r){if(t&1&&Fe(ht,7),t&2){let p;Te(p=De())&&(r.operationTpl=p.first)}},standalone:!0,features:[N],decls:25,vars:29,consts:[["operationTpl",""],["tableBtns",""],[3,"pageHeaderInfo"],[1,"normal-table-wrap"],["nzHoverable","",1,"m-b-10",3,"nzBodyStyle"],["nz-form",""],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],[3,"nzFor"],["name","roleName","nz-input","","placeholder","\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",3,"ngModelChange","ngModel"],["nz-col","",1,"text-right","p-0","m-b-10",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],["nz-button","",3,"click","nzType"],["nz-icon","","nzType","search"],["nz-button","",1,"m-l-15",3,"click"],["nz-icon","","nzTheme","outline","nzType","close-circle"],[3,"reload","btnTpl","tableTitle"],[3,"changePageNum","changePageSize","tableConfig","tableData"],["class","operate-text",3,"click",4,"appAuth"],[1,"operate-text",3,"click"],["class","m-r-8","nz-button","","nzType","primary",3,"click",4,"appAuth"],["nz-button","","nzType","primary",1,"m-r-8",3,"click"],["nz-icon","","nzType","plus"]],template:function(t,r){if(t&1){let p=y();h(0,"app-page-header",2),s(1,"div",3)(2,"nz-card",4)(3,"form",5)(4,"div",6)(5,"div",7)(6,"nz-form-item")(7,"nz-form-label",8),d(8,"\u89D2\u8272\u540D\u79F0"),l(),s(9,"nz-form-control")(10,"input",9),R("ngModelChange",function(S){return _(p),M(r.searchParam.roleName,S)||(r.searchParam.roleName=S),f(S)}),l()()()(),h(11,"div",7),s(12,"div",10)(13,"button",11),z("click",function(){return _(p),f(r.getDataList())}),h(14,"i",12),d(15," \u641C\u7D22 "),l(),s(16,"button",13),z("click",function(){return _(p),f(r.resetForm())}),h(17,"i",14),d(18," \u91CD\u7F6E "),l()()()()(),s(19,"app-card-table-wrap",15),z("reload",function(){return _(p),f(r.reloadTable())}),s(20,"app-ant-table",16),z("changePageNum",function(S){return _(p),f(r.getDataList(S))})("changePageSize",function(S){return _(p),f(r.changePageSize(S))}),l(),C(21,vt,3,3,"ng-template",null,0,w),l()(),C(23,Ft,1,1,"ng-template",null,1,w)}if(t&2){let p=F(24);m("pageHeaderInfo",r.pageHeaderInfo),a(2),m("nzBodyStyle",he(27,Ct)),a(2),m("nzGutter",he(28,zt)),a(),m("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),a(5),D("ngModel",r.searchParam.roleName),a(),m("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),a(),m("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),a(),m("nzType","primary"),a(6),m("btnTpl",p)("tableTitle","\u89D2\u8272\u5217\u8868"),a(),m("tableConfig",r.tableConfig)("tableData",r.dataList)}},dependencies:[_e,ue,de,V,j,H,k,$,G,ke,me,ne,ie,ae,re,se,le,oe,ce,pe,te,ee,J,K,Y,Q,q,tt,et,Ke],encapsulation:2,changeDetection:0});let e=o;return e})();var lt=(e,o)=>({$implicit:e,isOpen:o}),Tt=e=>({paddingLeft:e});function Dt(e,o){e&1&&d(0,"\u8FD4\u56DE")}function Mt(e,o){if(e&1){let i=y();s(0,"span",12),z("click",function(){_(i);let t=c().$implicit;return f(t.isOpen=!t.isOpen)}),h(1,"i",13),s(2,"span",14),d(3),l()()}if(e&2){let i=c().$implicit;a(),m("nzType",i.isOpen?"down":"right"),a(2),T(i.isOpen?"\u6536\u8D77":"\u5C55\u5F00")}}function Rt(e,o){e&1&&ge(0)}function Nt(e,o){if(e&1){let i=y();s(0,"span",12),z("click",function(){_(i);let t=c(2).$implicit;return f(t.isOpen=!t.isOpen)}),h(1,"i",13),s(2,"span",14),d(3),l()()}if(e&2){let i=c(2).$implicit;a(),m("nzType",i.isOpen?"down":"right"),a(2),T(i.isOpen?"\u6536\u8D77":"\u5C55\u5F00")}}function wt(e,o){if(e&1){let i=y();s(0,"div",15)(1,"label",7),R("ngModelChange",function(t){_(i);let r=c().$implicit;return M(r.checked,t)||(r.checked=t),f(t)}),d(2),l(),C(3,Nt,4,2,"span",8),l()}if(e&2){let i=c().$implicit;m("ngStyle",Me(4,Tt,i.level*16+"px")),a(),D("ngModel",i.checked),a(),T(i.menuName),a(),x(i.children&&i.children.length>0?3:-1)}}function kt(e,o){if(e&1){let i=y();s(0,"label",7),R("ngModelChange",function(t){let r=_(i).$implicit;return M(r.checked,t)||(r.checked=t),f(t)}),d(1),l()}if(e&2){let i=o.$implicit;D("ngModel",i.checked),a(),T(i.menuName)}}function Vt(e,o){if(e&1&&(s(0,"div",16)(1,"span"),d(2,"\u64CD\u4F5C\u6743\u9650\uFF1A"),l(),O(3,kt,2,2,"label",17,P),h(5,"nz-divider",9),l()),e&2){let i=c(4).$implicit;a(3),X(i)}}function Et(e,o){if(e&1&&C(0,Vt,6,0,"div",16),e&2){let i=c().$index;x(i===0?0:-1)}}function It(e,o){e&1&&ge(0)}function Lt(e,o){if(e&1&&C(0,wt,4,6,"div",15)(1,Et,1,1)(2,It,1,0,"ng-container",11),e&2){let i=o.$implicit;c(3);let n=F(9);x(i.menuType==="C"?0:1),a(2),m("ngTemplateOutlet",n)("ngTemplateOutletContext",Ce(3,lt,i.children,i.isOpen))}}function At(e,o){if(e&1&&O(0,Lt,3,6,"ng-container",null,P),e&2){let i=c().$implicit;X(i)}}function Pt(e,o){if(e&1&&C(0,At,2,0),e&2){let i=o.isOpen;x(i?0:-1)}}function Ot(e,o){if(e&1){let i=y();s(0,"li")(1,"div",6)(2,"label",7),R("ngModelChange",function(t){let r=_(i).$implicit;return M(r.checked,t)||(r.checked=t),f(t)}),d(3),l(),C(4,Mt,4,2,"span",8),l(),h(5,"nz-divider",9),s(6,"div",10),C(7,Rt,1,0,"ng-container",11),l(),C(8,Pt,1,1,"ng-template",null,1,w),l()}if(e&2){let i=o.$implicit,n=F(9);a(2),D("ngModel",i.checked),a(),T(i.menuName),a(),x(i.children&&i.children.length>0?4:-1),a(3),m("ngTemplateOutlet",n)("ngTemplateOutletContext",Ce(5,lt,i.children,i.isOpen))}}var st=(()=>{let o=class o{constructor(){this.pageHeaderInfo={title:"\u8BBE\u7F6E\u6743\u9650",desc:"\u5F53\u524D\u89D2\u8272\uFF1A",breadcrumb:["\u9996\u9875","\u7528\u6237\u7BA1\u7406","\u89D2\u8272\u7BA1\u7406","\u8BBE\u7F6E\u6743\u9650"]},this.authCodeArr=[],this.permissionList=[],this.destroyRef=u(A),this.dataService=u(fe),this.menusService=u(it),this.router=u(W),this.message=u(Z),this.cdr=u(B)}initPermission(){this.dataService.getPermissionById(this.id).pipe(be(n=>(this.authCodeArr=n,this.menusService.getMenuList({pageNum:0,pageSize:0}))),b(this.destroyRef)).subscribe(n=>{let t=n.list;t.forEach(r=>{r.isOpen=!1,r.checked=this.authCodeArr.includes(r.code)}),this.permissionList=Oe(Pe(t)),this.cdr.markForCheck()})}getRoleName(){this.dataService.getRolesDetail(+this.id).pipe(b(this.destroyRef)).subscribe(({roleName:n})=>{this.pageHeaderInfo=ye(I({},this.pageHeaderInfo),{desc:`\u5F53\u524D\u89D2\u8272\uFF1A${n}`}),this.cdr.markForCheck()})}back(){this.router.navigateByUrl("/default/system/role-manager")}submit(){let n=[...this.permissionList],t=Xe(n),r=[];t.forEach(g=>{g.checked&&r.push(`${g.id}`)});let p={permissionIds:r,roleId:+this.id};this.dataService.updatePermission(p).pipe(b(this.destroyRef)).subscribe(()=>{this.message.success("\u8BBE\u7F6E\u6210\u529F\uFF0C\u91CD\u65B0\u767B\u5F55\u540E\u751F\u6548")})}_onReuseInit(){this.ngOnInit()}ngOnInit(){this.getRoleName(),this.initPermission()}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=v({type:o,selectors:[["app-set-role"]],inputs:{id:"id"},standalone:!0,features:[N],decls:13,vars:3,consts:[["backTpl",""],["permissionTpl",""],[3,"backTpl","backUrl","pageHeaderInfo"],[1,"normal-table-wrap"],["nz-button","","nzType","primary",1,"right",3,"click"],["nz-button","","nzGhost","","nzType","primary",1,"right","m-l-20",3,"click"],[1,"first-menu"],["nz-checkbox","",3,"ngModelChange","ngModel"],[1,"hand-model"],[1,"m-0"],["nz-result-content","",1,"m-0","p-0"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"hand-model",3,"click"],["nz-icon","","nzTheme","outline",3,"nzType"],[1,"operate-text"],[1,"first-menu",3,"ngStyle"],[1,"operate-line","li-height","m-0","p-0","p-l-35"],["nz-checkbox","",3,"ngModel"]],template:function(t,r){if(t&1){let p=y();h(0,"app-page-header",2),C(1,Dt,1,0,"ng-template",null,0,w),s(3,"div",3)(4,"nz-card")(5,"ul"),O(6,Ot,10,8,"li",null,P),l()()(),s(8,"app-footer-submit")(9,"button",4),z("click",function(){return _(p),f(r.submit())}),d(10,"\u63D0\u4EA4"),l(),s(11,"button",5),z("click",function(){return _(p),f(r.back())}),d(12,"\u8FD4\u56DE"),l()()}if(t&2){let p=F(2);m("backTpl",p)("backUrl","/default/system/role-manager")("pageHeaderInfo",r.pageHeaderInfo),a(6),X(r.permissionList)}},dependencies:[_e,ue,de,We,Be,V,k,G,Q,q,te,ee,J,K,$e,He,Je,Ze,Ne,Re,Ye,Y],styles:[`.li-height{height:40px;line-height:40px}.first-menu{display:flex;align-items:center;justify-content:space-between;height:40px;line-height:40px}
`],encapsulation:2,changeDetection:0});let e=o;return e})();var sn=[{path:"",component:at,title:"\u89D2\u8272\u7BA1\u7406",data:{key:"role-manage"}},{path:"set-role",component:st,title:"\u89D2\u8272\u7BA1\u7406",data:{key:"set-role",authCode:U.RoleManagerSetRole}}];export{sn as default};
