import{a as Je}from"./chunk-P4RXLBZ5.js";import{a as Oe}from"./chunk-XDXAM5ZT.js";import{a as Ue,b as Ze}from"./chunk-GLFCZA7E.js";import"./chunk-FCQSZ6XN.js";import"./chunk-M5LQNN42.js";import"./chunk-LPWIGP7T.js";import{d as je,e as Qe}from"./chunk-A23SGRKQ.js";import{a as Ae,b as Be}from"./chunk-RWCWNF3A.js";import"./chunk-HKEGC24T.js";import"./chunk-UG7OVATA.js";import{a as We,b as Ge,c as He}from"./chunk-EWMUIEXZ.js";import{b as xe,h as Ve,i as Le}from"./chunk-VACRA7IX.js";import{a as qe}from"./chunk-UYI573E5.js";import"./chunk-O2WPPUR2.js";import"./chunk-QPYDJO7U.js";import"./chunk-CLJGZU7Y.js";import{a as ke,b as Pe}from"./chunk-2MHJOQQ7.js";import{a as Xe,b as Ie,c as Re}from"./chunk-ASVMZEEL.js";import"./chunk-YOPTE6SW.js";import"./chunk-HYXQY7LQ.js";import"./chunk-2KO7AHLC.js";import"./chunk-XSQZ233G.js";import{a as ge}from"./chunk-3D3NKZKE.js";import{b as ye,d as Ne}from"./chunk-BR5TRSLO.js";import"./chunk-V6VP5ZUC.js";import{d as be}from"./chunk-6G6375XT.js";import{b as he}from"./chunk-DBID6Z5F.js";import"./chunk-6ZE6SAQI.js";import"./chunk-O35JRGP6.js";import{f as Me,g as we}from"./chunk-YGFGTHXD.js";import"./chunk-HDT4KMAI.js";import"./chunk-IRQU3GS3.js";import"./chunk-WHSVXWNJ.js";import"./chunk-33MUP4H7.js";import{a as k,b as P,c as A,d as B,e as O}from"./chunk-23ZTSX7W.js";import"./chunk-VNID2NCF.js";import"./chunk-KZXNDGZT.js";import{a as W,e as G}from"./chunk-CUBBA5TV.js";import{d as M,e as se,g as w,h as x,j as de,k as ce,l as V,o as ue,r as fe,u as ze,w as L,x as _e}from"./chunk-WL72DHP4.js";import"./chunk-63CUI4A7.js";import"./chunk-BE5UFXKQ.js";import"./chunk-AOHLMCKO.js";import{a as X,b as I,c as R}from"./chunk-JG7PDFQU.js";import"./chunk-LMT2TBSV.js";import"./chunk-7PKCM743.js";import"./chunk-MCCZJH2J.js";import{a as Te,b as Se,c as ve,d as Ee,e as Fe}from"./chunk-S2KEA7XP.js";import{ca as Ce,da as De}from"./chunk-NYWSPOYR.js";import"./chunk-ZGT77FDO.js";import{a as y}from"./chunk-XMISJKZ6.js";import"./chunk-TLY6E2EZ.js";import"./chunk-I3AI2SV7.js";import{w as pe}from"./chunk-ZWOUEGUH.js";import{$b as ne,Aa as E,Ac as d,Cc as me,Fc as U,Gc as Z,Hc as J,Jc as F,Kb as ie,Kc as K,Ma as u,Na as f,Ob as D,Qb as r,Ua as ee,Uc as b,Z as N,Zb as H,ac as oe,bc as re,cc as l,dc as p,dd as le,ec as h,hc as ae,ic as T,oc as C,qa as $,qc as z,ub as m,vb as te,wa as c,wc as q,xc as j,yc as Q,z as v,zc as S}from"./chunk-XNENNAZS.js";import{a as Y}from"./chunk-VB56BUGO.js";function ot(e,i){if(e&1&&d(0),e&2){let s=z().$implicit;me(" ",s.errors.message," ")}}function rt(e,i){e&1&&d(0," \u5FC5\u586B\u9879 ")}function at(e,i){if(e&1&&D(0,ot,1,1)(1,rt,1,0),e&2){let s=i.$implicit;H(s.hasError("message")?0:-1),m(),H(s.hasError("required")?1:-1)}}var Ye=(()=>{let i=class i extends ke{constructor(n){super(n),this.modalRef=n,this.nzModalData=c(Xe),this.fb=c(ze)}initForm(){this.addEditForm=this.fb.group({departmentName:[null,[se.required]],state:[!0],orderNum:[0]})}getAsyncFnData(n){return v(n)}getCurrentValue(){return he(this.addEditForm)?v(this.addEditForm.value):v(!1)}ngOnInit(){this.initForm(),this.nzModalData&&this.addEditForm.patchValue(this.nzModalData)}};i.\u0275fac=function(t){return new(t||i)(te(Ie))},i.\u0275cmp=E({type:i,selectors:[["app-dept-manage-modal"]],standalone:!0,features:[ie,F],decls:22,vars:18,consts:[["combineTpl",""],["nz-form","",3,"formGroup"],["nzFor","departmentName","nzRequired","",3,"nzSm","nzXs"],[3,"nzErrorTip","nzSm","nzXs"],["id","departmentName","name","departmentName","formControlName","departmentName","nz-input","","placeholder","\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"],["nzFor","state","nzRequired","",3,"nzSm","nzXs"],["formControlName","state"],["nz-radio","",3,"nzValue"],["nzFor","orderNum","nzRequired","",3,"nzSm","nzXs"],["id","orderNum","name","orderNum","formControlName","orderNum","nz-input","","placeholder","\u6392\u5E8F"]],template:function(t,o){if(t&1&&(l(0,"form",1)(1,"nz-form-item")(2,"nz-form-label",2),d(3,"\u90E8\u95E8\u540D\u79F0"),p(),l(4,"nz-form-control",3),h(5,"input",4),p()(),l(6,"nz-form-item")(7,"nz-form-label",5),d(8,"\u90E8\u95E8\u72B6\u6001"),p(),l(9,"nz-form-control",3)(10,"nz-radio-group",6)(11,"label",7),d(12,"\u7981\u7528"),p(),l(13,"label",7),d(14,"\u53EF\u7528"),p()()()(),l(15,"nz-form-item")(16,"nz-form-label",8),d(17,"\u6392\u5E8F"),p(),l(18,"nz-form-control",3),h(19,"input",9),p()()(),D(20,at,2,2,"ng-template",null,0,b)),t&2){let a=S(21);r("formGroup",o.addEditForm),m(2),r("nzSm",6)("nzXs",24),m(2),r("nzErrorTip",a)("nzSm",14)("nzXs",24),m(3),r("nzSm",6)("nzXs",24),m(2),r("nzErrorTip",a)("nzSm",14)("nzXs",24),m(2),r("nzValue",!1),m(2),r("nzValue",!0),m(3),r("nzSm",6)("nzXs",24),m(2),r("nzErrorTip",a)("nzSm",14)("nzXs",24)}},dependencies:[L,V,M,w,x,O,I,X,P,k,B,A,_e,ue,fe,R,G,W,He,Ge,We],encapsulation:2,changeDetection:0});let e=i;return e})();var $e=(()=>{let i=class i{constructor(){this.modalWrapService=c(Pe)}getContentComponent(){return Ye}show(n={},t){return this.modalWrapService.show(this.getContentComponent(),n,t)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var mt=["operationTpl"],lt=["state"],pt=()=>({"padding-bottom":0}),st=()=>({xs:8,sm:16,md:24});function dt(e,i){if(e&1&&h(0,"nz-option",14),e&2){let s=i.$implicit;r("nzLabel",s.label)("nzValue",s.value)}}function ct(e,i){if(e&1){let s=T();l(0,"span",23),C("click",function(){u(s);let t=z(),o=t.fatherId,a=t.id,g=z();return f(g.edit(a,o))}),d(1,"\u7F16\u8F91"),p()}}function ut(e,i){if(e&1){let s=T();l(0,"span",23),C("click",function(){u(s);let t=z().id,o=z();return f(o.del(t))}),d(1,"\u5220\u9664"),p()}}function ft(e,i){if(e&1){let s=T();l(0,"span",23),C("click",function(){u(s);let t=z().id,o=z();return f(o.add(t))}),d(1,"\u6DFB\u52A0\u4E0B\u7EA7"),p()}}function zt(e,i){if(e&1&&D(0,ct,2,0,"span",22)(1,ut,2,0,"span",22)(2,ft,2,0,"span",22),e&2){let s=z();r("appAuth",s.ActionCode.DeptEdit),m(),r("appAuth",s.ActionCode.DeptDel),m(),r("appAuth",s.ActionCode.DeptAddLowLevel)}}function _t(e,i){if(e&1){let s=T();l(0,"button",24),C("click",function(){u(s);let t=z();return f(t.add(0))}),h(1,"i",25),d(2," \u65B0\u5EFA "),p()}}function gt(e,i){e&1&&ae(0)}function ht(e,i){if(e&1&&D(0,gt,1,0,"ng-container",26),e&2){let s=i.state;z();let n=S(35),t=S(37);r("ngTemplateOutlet",s?n:t)}}function Ct(e,i){e&1&&(l(0,"nz-tag",27),d(1,"\u53EF\u7528"),p()),e&2&&r("nzColor","green")}function Dt(e,i){e&1&&(l(0,"nz-tag",27),d(1,"\u7981\u7528"),p()),e&2&&r("nzColor","magenta")}var yi=(()=>{let i=class i{constructor(){this.ActionCode=ge,this.searchParam={},this.destroyRef=c(ee),this.pageHeaderInfo={title:"\u90E8\u95E8\u7BA1\u7406(\u53EAmock\u4E86\u5F00\u53D1\u90E8\u95E8\u8FD9\u4E00\u6761\u6570\u636E)",breadcrumb:["\u9996\u9875","\u7CFB\u7EDF\u7BA1\u7406","\u90E8\u95E8\u7BA1\u7406"]},this.dataList=[],this.stateOptions=[],this.deptModalService=c($e),this.dataService=c(Je),this.modalSrv=c(Re),this.message=c(be),this.cdr=c(le)}reloadTable(){this.message.info("\u5DF2\u7ECF\u5237\u65B0\u4E86"),this.getDataList()}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}tableLoading(n){this.tableConfig.loading=n,this.tableChangeDectction()}getDataList(n){this.tableConfig.loading=!0;let t={pageSize:0,pageNum:0,filters:this.searchParam};this.dataService.getDepts(t).pipe(N(()=>{this.tableLoading(!1)}),y(this.destroyRef)).subscribe(o=>{let a=ye(o.list);this.dataList=Ne(a),this.tableLoading(!1)})}check(n,t,o){this.message.success(n)}resetForm(){this.searchParam={},this.getDataList()}add(n){this.deptModalService.show({nzTitle:"\u65B0\u589E"}).pipe(N(()=>{this.tableLoading(!1)}),y(this.destroyRef)).subscribe(t=>{if(!t||t.status===0)return;let o=Y({},t.modalValue);o.fatherId=n,this.tableLoading(!0),this.addEditData(o,"addDepts")})}addEditData(n,t){this.dataService[t](n).pipe(N(()=>{this.tableLoading(!1)}),y(this.destroyRef)).subscribe(()=>{this.getDataList()})}del(n){let t=[n];this.modalSrv.confirm({nzTitle:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",nzContent:"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D",nzOnOk:()=>{this.tableLoading(!0),this.dataService.delDepts(t).pipe(N(()=>{this.tableLoading(!1)}),y(this.destroyRef)).subscribe(()=>{this.dataList.length===1&&this.tableConfig.pageIndex--,this.getDataList()})}})}edit(n,t){this.dataService.getDeptsDetail(n).pipe(y(this.destroyRef)).subscribe(o=>{this.deptModalService.show({nzTitle:"\u7F16\u8F91"},o).pipe(N(()=>{this.tableLoading(!1)}),y(this.destroyRef)).subscribe(({modalValue:a,status:g})=>{g!==0&&(a.id=n,a.fatherId=t,this.tableLoading(!0),this.addEditData(a,"editDepts"))})})}changePageSize(n){this.tableConfig.pageSize=n}initTable(){this.tableConfig={headers:[{title:"\u90E8\u95E8\u540D\u79F0",width:230,field:"departmentName"},{title:"\u90E8\u95E8\u72B6\u6001",field:"state",tdTemplate:this.state,width:100},{title:"\u6392\u5E8F",field:"orderNum",width:100},{title:"\u521B\u5EFA\u65F6\u95F4",field:"createTime",pipe:"date:yyyy-MM-dd HH:mm",width:180},{title:"\u64CD\u4F5C",tdTemplate:this.operationTpl,width:180,fixed:!1,fixedDir:"right"}],total:0,showCheckbox:!1,loading:!1,pageSize:10,pageIndex:1}}ngOnInit(){this.initTable(),this.stateOptions=[...Qe.transformMapToArray(je.available,2)]}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=E({type:i,selectors:[["app-dept"]],viewQuery:function(t,o){if(t&1&&(q(mt,7),q(lt,7)),t&2){let a;j(a=Q())&&(o.operationTpl=a.first),j(a=Q())&&(o.state=a.first)}},standalone:!0,features:[F],decls:38,vars:30,consts:[["operationTpl",""],["tableBtns",""],["state",""],["yesTpl",""],["notTpl",""],[3,"pageHeaderInfo"],[1,"normal-table-wrap"],["nzHoverable","",1,"m-b-10",3,"nzBodyStyle"],["nz-form",""],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],[3,"nzFor"],["name","departmentName","nz-input","","placeholder","\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",3,"ngModelChange","ngModel"],["name","state","nzAllowClear","","nzPlaceHolder","\u4E0B\u62C9\u9009\u62E9",3,"ngModelChange","ngModel"],[3,"nzLabel","nzValue"],["nz-col","",1,"text-right","p-0","m-b-10",3,"nzLg","nzMd","nzSm","nzXl","nzXs","nzXXl"],["nz-button","",3,"click","nzType"],["nz-icon","","nzType","search"],["nz-button","",1,"m-l-15",3,"click"],["nz-icon","","nzTheme","outline","nzType","close-circle"],[3,"reload","btnTpl","tableTitle"],[3,"changePageNum","changePageSize","tableConfig","tableData"],["class","operate-text",3,"click",4,"appAuth"],[1,"operate-text",3,"click"],["nz-button","","nzType","primary",1,"m-r-8",3,"click"],["nz-icon","","nzType","plus"],[4,"ngTemplateOutlet"],[3,"nzColor"]],template:function(t,o){if(t&1){let a=T();h(0,"app-page-header",5),l(1,"div",6)(2,"nz-card",7)(3,"form",8)(4,"div",9)(5,"div",10)(6,"nz-form-item")(7,"nz-form-label",11),d(8,"\u90E8\u95E8\u540D\u79F0"),p(),l(9,"nz-form-control")(10,"input",12),J("ngModelChange",function(_){return u(a),Z(o.searchParam.departmentName,_)||(o.searchParam.departmentName=_),f(_)}),p()()()(),l(11,"div",10)(12,"nz-form-item")(13,"nz-form-label",11),d(14,"\u72B6\u6001"),p(),l(15,"nz-form-control")(16,"nz-select",13),J("ngModelChange",function(_){return u(a),Z(o.searchParam.state,_)||(o.searchParam.state=_),f(_)}),oe(17,dt,1,2,"nz-option",14,ne),p()()()(),l(19,"div",15)(20,"button",16),C("click",function(){return u(a),f(o.getDataList())}),h(21,"i",17),d(22," \u641C\u7D22 "),p(),l(23,"button",18),C("click",function(){return u(a),f(o.resetForm())}),h(24,"i",19),d(25," \u91CD\u7F6E "),p()()()()(),l(26,"app-card-table-wrap",20),C("reload",function(){return u(a),f(o.reloadTable())}),l(27,"app-tree-table",21),C("changePageNum",function(_){return u(a),f(o.getDataList(_))})("changePageSize",function(_){return u(a),f(o.changePageSize(_))}),p(),D(28,zt,3,3,"ng-template",null,0,b),p()(),D(30,_t,3,0,"ng-template",null,1,b)(32,ht,1,1,"ng-template",null,2,b)(34,Ct,2,1,"ng-template",null,3,b)(36,Dt,2,1,"ng-template",null,4,b)}if(t&2){let a=S(31);r("pageHeaderInfo",o.pageHeaderInfo),m(2),r("nzBodyStyle",K(28,pt)),m(2),r("nzGutter",K(29,st)),m(),r("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),m(5),U("ngModel",o.searchParam.departmentName),m(),r("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),m(5),U("ngModel",o.searchParam.state),m(),re(o.stateOptions),m(2),r("nzLg",8)("nzMd",12)("nzSm",24)("nzXl",8)("nzXs",24)("nzXXl",8),m(),r("nzType","primary"),m(6),r("btnTpl",a)("tableTitle","\u90E8\u95E8\u5217\u8868"),m(),r("tableConfig",o.tableConfig)("tableData",o.dataList)}},dependencies:[qe,we,Me,L,V,M,w,x,ce,de,O,I,X,P,k,B,A,R,G,W,Le,xe,Ve,Fe,Ee,Te,Se,ve,De,Ce,Ze,Ue,Oe,pe,Be,Ae],encapsulation:2,changeDetection:0});let e=i;return e})();export{yi as DeptComponent};
