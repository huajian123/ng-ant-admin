import{c as X}from"./chunk-ASVMZEEL.js";import{b as J}from"./chunk-YOPTE6SW.js";import{a as re}from"./chunk-V6VP5ZUC.js";import{c as U,g as W}from"./chunk-DBID6Z5F.js";import{ca as H,da as K}from"./chunk-NYWSPOYR.js";import{a as u}from"./chunk-XMISJKZ6.js";import{x as Q}from"./chunk-ZWOUEGUH.js";import{Aa as T,Bb as R,Ha as _,Ic as Z,Jc as A,Ma as S,Na as g,Ob as j,Pc as V,Qb as E,Qc as G,Sa as w,Ua as k,Uc as B,_ as v,_c as P,cc as x,dc as C,ec as F,i as y,ic as O,ka as h,ld as q,oc as I,qa as m,qc as p,ta as z,ub as D,wa as a,wc as $,xc as L,yc as N,z as M}from"./chunk-XNENNAZS.js";import{g as le}from"./chunk-VB56BUGO.js";var f=(()=>{let n=class n{constructor(){this.modalFullStatusStore$=new y(!1)}setModalFullStatusStore(t){this.modalFullStatusStore$.next(t)}getModalFullStatusStore(){return this.modalFullStatusStore$.asObservable()}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=m({token:n,factory:n.\u0275fac,providedIn:"root"});let o=n;return o})();var ae=["componentTpl"];function ie(o,n){if(o&1){let s=O();x(0,"span",1),I("click",function(e){S(s);let l=p();return g(l.fullScreenIconClick(e))}),F(1,"i",2),V(2,"async"),C(),x(3,"span",3),I("click",function(){S(s);let e=p();return g(e.closeModal())}),F(4,"i",4),C()}if(o&2){let s=p();D(),E("nzType",G(2,1,s.modalFullStatus$)?"fullscreen-exit":"fullscreen")}}var b=class{constructor(){this.modalFullScreenFlag=!1}},ee=(()=>{let n=class n{constructor(){this.modalFullScreenFlag=!1,this.modalFullStatus=a(f),this.modalFullStatus$=this.modalFullStatus.getModalFullStatusStore(),this.modalFullStatus$.pipe(u()).subscribe(t=>this.modalFullScreenFlag=t)}fullScreenIconClick(t){this.modalFullScreenFlag=!this.modalFullScreenFlag,this.modalFullStatus.setModalFullStatusStore(this.modalFullScreenFlag),U(t)}closeModal(){this.modalFullScreenFlag=!1,this.modalFullStatus.setModalFullStatusStore(!1)}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=T({type:n,selectors:[["app-global-modal-btn-tpl"]],viewQuery:function(e,l){if(e&1&&$(ae,7),e&2){let r;L(r=N())&&(l.componentTpl=r.first)}},standalone:!0,features:[Z([{provide:b,useExisting:n}]),A],decls:2,vars:0,consts:[["componentTpl",""],[1,"hover-blue","full-height","flex-auto","text-right","d-i-b",3,"click"],["nz-icon","","nzTheme","outline",1,"m-r-8",3,"nzType"],[1,"hover-red","full-height","flex-auto","d-i-b",2,"margin-right","14px",3,"click"],["nz-icon","","nzTheme","outline","nzType","close"]],template:function(e,l){e&1&&j(0,ie,5,3,"ng-template",null,0,B)},dependencies:[K,H,Q],encapsulation:2,changeDetection:0});let o=n;return o})();var te=new z("modal action btn token",{providedIn:"root",factory:()=>{let o=a(P),n=a(_),s=q(ee,{environmentInjector:n});return o.attachView(s.hostView),s}});var oe=le(re());var ne=class{constructor(n){this.modalRef=n}},Ee=(()=>{let n=class n{constructor(){this.destroyRef=a(k),this.baseInjector=a(w),this.modalFullStatusStoreService=a(f),this.dragDrop=a(J),this.rendererFactory=a(R),this.btnComponentRef=a(te),this.bsModalService=this.baseInjector.get(X),this.renderer=this.rendererFactory.createRenderer(null,null),this.btnTpl=this.btnComponentRef.instance.componentTpl,this.modalFullStatusStoreService.getModalFullStatusStore().pipe(u()).subscribe(t=>{this.fullScreenIconClick(t)})}fullScreenIconClick(t){this.bsModalService.openModals.forEach(e=>{t?this.renderer.addClass(e.containerInstance.host.nativeElement,"fullscreen-modal"):this.renderer.removeClass(e.containerInstance.host.nativeElement,"fullscreen-modal")})}getRandomCls(){return`NZ-MODAL-WRAP-CLS-${W()}`}cancelCallback(t){return this.modalFullStatusStoreService.setModalFullStatusStore(!1),t.modalRef.destroy({status:0,value:null})}confirmCallback(t){t.modalRef.componentInstance.getCurrentValue().pipe(h(e=>(this.modalFullStatusStoreService.setModalFullStatusStore(!1),e?t.modalRef.destroy({status:1,modalValue:e}):M(!1))),u(this.destroyRef)).subscribe()}getZIndex(t){return+getComputedStyle(t,null).zIndex}getModalMaxZIndex(t){return this.bsModalService.openModals.reduce((e,l)=>{let r=l.containerInstance.host.nativeElement;if(t===r)return e;let i=this.getZIndex(r);return i>=e.zIndex&&(e.zIndex=i,e.canChange=!0),e},{zIndex:this.getZIndex(t),canChange:!1})}setMaxZIndex(t){t.addEventListener("mousedown",()=>{let e=this.getModalMaxZIndex(t);e.canChange&&(t.style.zIndex=`${e.zIndex+1}`)},!1)}createDrag(t){let e=document.querySelector(`.${t}`),l=e.querySelector(".ant-modal-content"),r=l.querySelector(".ant-modal-header"),i=this.getModalMaxZIndex(e);return i.canChange&&(e.style.zIndex=`${i.zIndex+1}`),this.setMaxZIndex(e),r?(r.className+=" hand-model-move",this.dragDrop.createDrag(r).withHandles([r]).withRootElement(l)):this.dragDrop.createDrag(l).withHandles([l])}fixedWrapElementStyle(t){t.style.pointerEvents="none"}createModalConfig(t,e={},l,r){let i={nzTitle:"",nzContent:t,nzCloseIcon:e.nzCloseIcon||this.btnTpl,nzMaskClosable:!1,nzFooter:[{label:"\u786E\u8BA4",type:"primary",show:!0,onClick:this.confirmCallback.bind(this)},{label:"\u53D6\u6D88",type:"default",show:!0,onClick:this.cancelCallback.bind(this)}],nzOnCancel:()=>new Promise(d=>{d({status:0,value:null})}),nzClosable:!0,nzWidth:720,nzData:l},c=oe.default.merge(i,e);return c.nzWrapClassName=`${c.nzWrapClassName||""} ${r}`,c}show(t,e={},l){let r=this.getRandomCls(),i=this.createModalConfig(t,e,l,r),c=this.bsModalService.create(i),d;return c.afterOpen.pipe(v(),u(this.destroyRef)).subscribe(()=>{d=this.createDrag(r)}),c.afterClose.pipe(h(()=>{d.dispose(),d=null,this.modalFullStatusStoreService.setModalFullStatusStore(!1)}))}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=m({token:n,factory:n.\u0275fac,providedIn:"root"});let o=n;return o})();export{ne as a,Ee as b};
